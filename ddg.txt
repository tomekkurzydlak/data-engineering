<mxfile host="app.diagrams.net" modified="2026-02-03T00:00:00.000Z" agent="" version="24.7.5">
  <diagram id="netsec" name="- Network & Trust Boundaries">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- TRUST BOUNDARY: External -->
        <mxCell id="tb_ext" value="Trust Boundary: External / Internet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="520" height="980" as="geometry"/>
        </mxCell>

        <!-- TRUST BOUNDARY: GCP -->
        <mxCell id="tb_gcp" value="Trust Boundary: Google Cloud Platform (Project / Org)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#eef5ff;strokeColor=#4a86e8;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="560" y="20" width="860" height="980" as="geometry"/>
        </mxCell>

        <!-- TRUST BOUNDARY: On-Prem -->
        <mxCell id="tb_onprem" value="Trust Boundary: On-Prem (Corporate Network)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1440" y="20" width="460" height="980" as="geometry"/>
        </mxCell>

        <!-- External components -->
        <mxCell id="ext_actor" value="Actor / Source System" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="tb_ext">
          <mxGeometry x="80" y="90" width="360" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="ext_sharepoint" value="SharePoint (optional SaaS)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="tb_ext">
          <mxGeometry x="80" y="190" width="360" height="70" as="geometry"/>
        </mxCell>

        <!-- GCP zones inside tb_gcp -->
        <mxCell id="gcp_public" value="GCP Public / Edge" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;dashed=1;" vertex="1" parent="tb_gcp">
          <mxGeometry x="40" y="80" width="780" height="170" as="geometry"/>
        </mxCell>

        <mxCell id="gcp_private" value="GCP Private (VPC / Private Access)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;dashed=1;" vertex="1" parent="tb_gcp">
          <mxGeometry x="40" y="280" width="780" height="420" as="geometry"/>
        </mxCell>

        <mxCell id="gcp_messaging" value="GCP Messaging" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;dashed=1;" vertex="1" parent="tb_gcp">
          <mxGeometry x="40" y="730" width="780" height="220" as="geometry"/>
        </mxCell>

        <!-- GCP components -->
        <mxCell id="gcs_ingest2" value="GCS Bucket: ingest&#10;(original files)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_public">
          <mxGeometry x="30" y="60" width="300" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="cloudrun_boundary" value="Cloud Run (serverless)&#10;Steps: meta / pdf2md / writer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_public">
          <mxGeometry x="360" y="60" width="380" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="vpc" value="VPC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_private">
          <mxGeometry x="30" y="50" width="710" height="340" as="geometry"/>
        </mxCell>

        <mxCell id="subnet_gke" value="Subnet: GKE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;dashed=1;" vertex="1" parent="vpc">
          <mxGeometry x="30" y="60" width="320" height="250" as="geometry"/>
        </mxCell>

        <mxCell id="gke_watchers2" value="GKE Orchestrator / Watchers&#10;(scan bucket, trigger dispatcher)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="subnet_gke">
          <mxGeometry x="20" y="80" width="280" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="subnet_db" value="Subnet: Private Services / DB" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;dashed=1;" vertex="1" parent="vpc">
          <mxGeometry x="380" y="60" width="300" height="250" as="geometry"/>
        </mxCell>

        <mxCell id="pg2" value="PostgreSQL (GCP)&#10;metadata definitions + statuses&#10;(private IP)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="subnet_db">
          <mxGeometry x="20" y="80" width="260" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="nat_egress" value="Controlled Egress&#10;(NAT / egress policy)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_private">
          <mxGeometry x="30" y="410" width="340" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="logging" value="Logging / Monitoring&#10;(Cloud Logging, Metrics)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_private">
          <mxGeometry x="400" y="410" width="340" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="pubsub2" value="Pub/Sub Topic: file-metadata" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_messaging">
          <mxGeometry x="30" y="70" width="340" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="subs2" value="Subscriptions&#10;(business clients)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4a86e8;" vertex="1" parent="gcp_messaging">
          <mxGeometry x="400" y="70" width="340" height="70" as="geometry"/>
        </mxCell>

        <!-- On-Prem components -->
        <mxCell id="onprem_dispatcher2" value="Dispatcher (on-prem)&#10;calls Cloud Run, polls status" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;" vertex="1" parent="tb_onprem">
          <mxGeometry x="50" y="170" width="360" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="onprem_publisher2" value="On-prem Publisher&#10;publishes metadata to Pub/Sub" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;" vertex="1" parent="tb_onprem">
          <mxGeometry x="50" y="320" width="360" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="onprem_clients2" value="Business Clients&#10;(consume subscriptions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="tb_onprem">
          <mxGeometry x="50" y="740" width="360" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="link_vpn" value="On-prem ↔ GCP Connectivity&#10;(Cloud VPN / Interconnect)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="tb_onprem">
          <mxGeometry x="50" y="80" width="360" height="70" as="geometry"/>
        </mxCell>

        <!-- Edges -->
        <mxCell id="ne1" value="HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="ext_actor" target="ext_sharepoint">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne2" value="HTTPS/TLS (copy/transfer)" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="ext_sharepoint" target="gcs_ingest2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne3" value="GCS API&#10;HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gke_watchers2" target="gcs_ingest2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne4" value="DB (TCP/TLS)&#10;private IP" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="gke_watchers2" target="pg2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne5" value="Trigger dispatcher&#10;HTTPS/TLS over VPN/Interconnect" style="endArrow=block;html=1;strokeWidth=2;dashed=1;" edge="1" parent="1" source="gke_watchers2" target="onprem_dispatcher2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne6" value="Invoke / Start steps&#10;HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="onprem_dispatcher2" target="cloudrun_boundary">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne7" value="Read/Write artifacts&#10;HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="cloudrun_boundary" target="gcs_ingest2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne8" value="Save run status&#10;DB (TCP/TLS)&#10;private IP" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="onprem_dispatcher2" target="pg2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne9" value="Trigger publish" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="onprem_dispatcher2" target="onprem_publisher2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne10" value="Publish&#10;HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;dashed=1;" edge="1" parent="1" source="onprem_publisher2" target="pubsub2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne11" value="Subscribe&#10;HTTPS/TLS" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="subs2" target="onprem_clients2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne12" value="Topic → Subscriptions" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="pubsub2" target="subs2">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne13" value="Egress controls" style="endArrow=block;html=1;strokeWidth=2;dashed=1;" edge="1" parent="1" source="vpc" target="nat_egress">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="ne14" value="Logs / metrics" style="endArrow=block;html=1;strokeWidth=2;dashed=1;" edge="1" parent="1" source="cloudrun_boundary" target="logging">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Connectivity line (visual hint) -->
        <mxCell id="ne15" value="VPN/Interconnect link (transport)&#10;App-layer TLS end-to-end" style="endArrow=none;startArrow=none;html=1;strokeWidth=3;dashed=1;strokeColor=#d6b656;" edge="1" parent="1" source="link_vpn" target="tb_gcp">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
